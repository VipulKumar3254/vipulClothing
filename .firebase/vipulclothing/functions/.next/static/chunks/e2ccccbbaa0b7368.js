(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,24203,e=>{"use strict";var s=e.i(43476),t=e.i(71645);e.i(51718);var r=e.i(6973);e.i(36180);var l=e.i(98925),d=e.i(89475),a=e.i(5766);function i(){let[e,i]=(0,t.useState)(!1),[n,o]=(0,t.useState)([]),[c,u]=(0,t.useState)(!0),[m,h]=(0,t.useState)("All"),[x,j]=(0,t.useState)(null),[p,g]=(0,t.useState)(!1),[v,b]=(0,t.useState)(!1);(0,t.useEffect)(()=>{let e=(0,r.getAuth)();(0,r.onAuthStateChanged)(e,async e=>{if(!e)return;let s=(0,l.doc)(d.db,"users",e.uid),t=await (0,l.getDoc)(s);t.exists()&&t.data().isAdmin?(i(!0),N()):(console.log("No admin privileges"),u(!1))})},[]);let N=()=>{let e=(0,l.collection)(d.db,"orders"),s=(0,l.onSnapshot)(e,e=>{let s=e.docs.map(e=>({orderId:e.id,...e.data()}));s.sort((e,s)=>s.date-e.date),o(s),u(!1)});return()=>s()},f=async(e,s)=>{try{await (0,l.updateDoc)((0,l.doc)(d.db,"orders",e),{status:s}),a.toast.success(`Order status updated to: ${s}`,{duration:3e3})}catch(e){console.error("Error updating status:",e),a.toast.error("Failed to update order status")}},y=async e=>{g(!0);try{let s=(0,l.doc)(d.db,"users",e),t=await (0,l.getDoc)(s);t.exists()?j(t.data()):a.toast.error("User not found")}catch(e){console.error("Error fetching user:",e),a.toast.error("Failed to fetch user details")}g(!1),b(!0)},A="All"===m?n:n.filter(e=>e.status===m);return(0,s.jsxs)("div",{className:"container my-4",style:{minHeight:"500px",fontFamily:"Jost Variable"},children:[(0,s.jsx)(a.Toaster,{position:"bottom-left"}),(0,s.jsx)("h2",{className:"text-center mb-4",children:"All Orders (Admin)"}),e&&!c&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"form-label me-2 fw-bold",children:"Filter by Status:"}),(0,s.jsxs)("select",{className:"form-select w-auto d-inline-block",value:m,onChange:e=>h(e.target.value),children:[(0,s.jsx)("option",{value:"All",children:"All"}),(0,s.jsx)("option",{value:"Reject",children:"Reject"}),(0,s.jsx)("option",{value:"Order Requested",children:"Requested"}),(0,s.jsx)("option",{value:"Order Accepted",children:"Accepted"}),(0,s.jsx)("option",{value:"Order Processing",children:"Processing"}),(0,s.jsx)("option",{value:"Out For Delivery",children:"Out for Delivery"}),(0,s.jsx)("option",{value:"Order Complete",children:"Complete"}),(0,s.jsx)("option",{value:"Return Requested",children:"Return Requested"}),(0,s.jsx)("option",{value:"Return Complete",children:"Return Complete"})]})]}),e?c?(0,s.jsx)("p",{className:"text-center",children:"Loading..."}):A.length>0?A.map((e,t)=>(0,s.jsxs)("div",{className:"card mb-4 shadow-sm p-3",children:[(0,s.jsxs)("h5",{className:"mb-3",children:["Order ID: ",(0,s.jsx)("span",{className:"text-primary",children:e.orderId})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Status:"})," ",e.status]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Payment Status:"})," ",e.paymentStatus]}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)("div",{className:"row",children:e.products?.map((e,t)=>(0,s.jsx)("div",{className:"col-md-4 col-sm-6 mb-3",children:(0,s.jsxs)("div",{className:"border rounded p-2 h-100 d-flex",children:[(0,s.jsx)("img",{src:e.photo[0],alt:e.title,className:"img-fluid mb-2",style:{height:"150px",objectFit:"cover",borderRadius:"8px"}}),(0,s.jsxs)("div",{className:"ms-3",children:[(0,s.jsx)("div",{children:(0,s.jsx)("strong",{children:e.title})}),(0,s.jsxs)("div",{children:["Size: ",e.size]}),(0,s.jsxs)("div",{children:["₹",e.price]})]})]})},t))})}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("strong",{children:"Subtotal:"})," ₹",e.subtotal,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Shipping:"})," ₹",e.shipping,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Discount:"})," ₹",e.discount,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Total Amount:"})," ",(0,s.jsxs)("span",{className:"text-success fw-bold",children:["₹",e.totalAmount]})]}),(0,s.jsx)("div",{className:"mt-2 text-muted",children:(0,s.jsxs)("small",{children:["Ordered At:"," ",e.createdAt?.seconds?new Date(1e3*e.createdAt.seconds).toLocaleString():"N/A"]})}),(0,s.jsxs)("div",{className:"mt-3 d-flex gap-2",children:[(0,s.jsxs)("div",{className:"dropdown",children:[(0,s.jsx)("button",{className:"btn btn-outline-primary dropdown-toggle",type:"button","data-bs-toggle":"dropdown",children:"Update Status"}),(0,s.jsx)("ul",{className:"dropdown-menu",children:["Reject","Order Requested","Order Accepted","Order Processing","Out For Delivery","Order Complete","Return Requested","Return Complete"].map(t=>(0,s.jsx)("li",{children:(0,s.jsx)("button",{className:"dropdown-item",onClick:()=>f(e.orderId,t),children:t})},t))})]}),(0,s.jsx)("button",{className:"btn btn-info",onClick:()=>y(e.userId),children:"View Details"})]})]},t)):(0,s.jsx)("p",{className:"text-center",children:"No orders found."}):(0,s.jsx)("p",{className:"text-center text-danger mt-5",children:"You must be an admin to view this page."}),v&&(0,s.jsx)("div",{className:"custom-modal-overlay",onClick:()=>b(!1),children:(0,s.jsxs)("div",{className:"custom-modal",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"custom-modal-header",children:[(0,s.jsx)("h5",{children:"User Details"}),(0,s.jsx)("button",{className:"close-btn",onClick:()=>b(!1),children:"✖"})]}),(0,s.jsx)("div",{className:"custom-modal-body",children:p?(0,s.jsx)("p",{children:"Loading user details..."}):x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Name:"})," ",x.name]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Email:"})," ",x.email]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Phone:"})," ",x.phone]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Address:"})," ",x.address]})]}):(0,s.jsx)("p",{children:"No user details available."})})]})})]})}e.s(["default",()=>i])}]);