{"version":3,"sources":["../../../../src/app/orders/page.jsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\r\nimport {\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  orderBy,\r\n  query,\r\n  updateDoc,\r\n} from \"firebase/firestore\";\r\nimport { db } from \"@/firebaseConfig\";\r\nimport { Toaster, toast } from \"react-hot-toast\";\r\nimport \"@fontsource-variable/jost\";\r\n\r\n\r\n\r\nfunction UserOrders() {\r\n  const [user, setUser] = useState(null);\r\n  const [orders, setOrders] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const auth = getAuth();\r\n    onAuthStateChanged(auth, (user) => {\r\n      if (user) {\r\n        setUser(user);\r\n        fetchOrders(user);\r\n      } else {\r\n        setUser(null);\r\n        setOrders([]);\r\n        setLoading(false);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const fetchOrders = async (user) => {\r\n    if (!user) return;\r\n    setLoading(true);\r\n\r\n    try {\r\n      const ordersQuery = query(\r\n      collection(db, `users/${user.uid}/orders`),\r\n      orderBy(\"date\", \"desc\")\r\n    );\r\n      const ordersSnapshot = await getDocs(ordersQuery);\r\n\r\n      const ordersPromises = ordersSnapshot.docs.map(async (order) => {\r\n        const orderData = order.data();\r\n        const orderRef = orderData.docRef;\r\n        const orderSnap = await getDoc(orderRef);\r\n        return { orderId: orderSnap.id, ...orderSnap.data() };\r\n      });\r\n\r\n      const tempOrders = await Promise.all(ordersPromises);\r\n      console.log(tempOrders);\r\n      // tempOrders.sort((a, b) => b.date - a.date);\r\n      setOrders(tempOrders);\r\n    } catch (error) {\r\n      console.error(\"Error fetching orders:\", error);\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  const cancelOrder = async (orderId) => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      await updateDoc(doc(db, \"orders\", orderId), {\r\n        status: \"Order Cancelled\",\r\n      });\r\n      toast.success(\"Order canceled successfully.\");\r\n      fetchOrders(user);\r\n    } catch (error) {\r\n      console.error(\"Error canceling order:\", error);\r\n      toast.error(\"Failed to cancel the order.\");\r\n    }\r\n  };\r\n\r\n  const returnOrder = async (orderId) => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      await updateDoc(doc(db, \"orders\", orderId), {\r\n        status: \"Return Requested\",\r\n      });\r\n\r\n      toast.success(\"Return request is raised, we will contact you shortly.\");\r\n    } catch (error) {\r\n      console.error(\"Error requesting return:\", error);\r\n      toast.error(\r\n        \"Can't create return request at the moment. Please try again later.\"\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className={`container my-4 `}\r\n        style={{ minHeight: \"500px\" , fontFamily:\"Jost Variable\" }}\r\n      >\r\n        <Toaster position=\"bottom-left\" />\r\n\r\n        {loading ? (\r\n          <div className=\"row\">\r\n            {[...Array(4)].map((_, index) => (\r\n              <div className=\"col-12 col-md-6 col-lg-3 mb-3\" key={index}>\r\n                <div className=\"card shadow-sm h-100 placeholder-glow\">\r\n                  <div\r\n                    className=\"text-center p-3\"\r\n                    style={{ background: \"#f8f6f9\", height: \"150px\" }}\r\n                  >\r\n                    <div className=\"placeholder w-75 h-100 mx-auto rounded\"></div>\r\n                  </div>\r\n                  <div className=\"card-body\">\r\n                    <h5 className=\"card-title placeholder col-6\"></h5>\r\n                    <p className=\"placeholder col-4 mb-2\"></p>\r\n                    <p className=\"placeholder col-3 mb-2\"></p>\r\n                    <p className=\"placeholder col-6 mb-2\"></p>\r\n                    <p className=\"placeholder col-5 mb-2\"></p>\r\n                  </div>\r\n                  <div className=\"card-footer bg-white text-center\">\r\n                    <div className=\"btn placeholder col-8\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          orders.map((order, index) => (\r\n            <div key={index} className=\"card mb-4 shadow-sm p-3\">\r\n              <h5 className=\"mb-3\">\r\n                Order ID:{\" \"}\r\n                <span className=\"text-primary\">{order.orderId}</span>\r\n              </h5>\r\n\r\n              <div>\r\n                <strong>Status:</strong> {order.status}\r\n              </div>\r\n              <div>\r\n                <strong>Payment Status:</strong> {order.paymentStatus}\r\n              </div>\r\n\r\n              <div className=\"mt-3\">\r\n                <div className=\"row\">\r\n                  {order.products.map((prod, idx) => (\r\n                    <div key={idx} className=\"col-md-4 col-sm-6 mb-3\">\r\n                      <div className=\"border rounded p-2 h-100 d-flex\">\r\n                        <img\r\n                          src={prod.photo[0]}\r\n                          alt={prod.title}\r\n                          className=\"img-fluid mb-2\"\r\n                          style={{\r\n                            height: \"150px\",\r\n                            objectFit: \"cover\",\r\n                            borderRadius: \"8px\",\r\n                          }}\r\n                        />\r\n                        <div className=\"ms-3\">\r\n                          <strong>{prod.title}</strong>\r\n                          <div>Size: {prod.size}</div>\r\n                          <div>₹{prod.price}</div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"mt-2\">\r\n                <strong>Subtotal:</strong> ₹{order.subtotal}\r\n                <br />\r\n                <strong>Shipping:</strong> ₹{order.shipping}\r\n                <br />\r\n                <strong>Discount:</strong> ₹{order.discount}\r\n                <br />\r\n                <strong>Total Amount:</strong>{\" \"}\r\n                <span className=\"text-success fw-bold\">\r\n                  ₹{order.totalAmount}\r\n                </span>\r\n              </div>\r\n\r\n              <div className=\"mt-2 text-muted\">\r\n                <small>\r\n                  Ordered At:{\" \"}\r\n                  {new Date(order.createdAt.seconds * 1000).toLocaleString()}\r\n                </small>\r\n              </div>\r\n            </div>\r\n          ))\r\n        )}\r\n      </div>\r\n\r\n      <div style={{ marginTop: \"200px\" }}>\r\n        <div>\r\n          <h1 className=\"text-center\">Important Information</h1>\r\n        </div>\r\n        <div className=\"mt-4 text-center\">\r\n          <p>\r\n            If you need any help with your order, our support team is here for\r\n            you.\r\n          </p>\r\n          <p>\r\n            Contact us at{\" \"}\r\n            <a href=\"mailto:vipulkumar3254@gmail.com\">\r\n              vipulkumar3254@gmail.com\r\n            </a>{\" \"}\r\n            or call +918307949189.\r\n          </p>\r\n          <p>\r\n            We’re happy to assist with order status, cancellations, or any other\r\n            queries.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default UserOrders;\r\n"],"names":[],"mappings":"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"}