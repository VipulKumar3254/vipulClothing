{"version":3,"sources":["../../../../src/app/adminPanel/queries/page.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { collection, getDocs, query, orderBy, updateDoc, doc } from \"firebase/firestore\";\r\nimport { db } from \"@/firebaseConfig\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nconst UserQueries = () => {\r\n  const [queries, setQueries] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [filter, setFilter] = useState(\"all\"); // all | solved | unsolved\r\n\r\n  const fetchQueries = async () => {\r\n    try {\r\n      const q = query(collection(db, \"concerns\"), orderBy(\"timestamp\", \"desc\"));\r\n      const querySnapshot = await getDocs(q);\r\n      const results = querySnapshot.docs.map((docSnap) => ({\r\n        id: docSnap.id,\r\n        solved: docSnap.data().solved || false, // read from Firestore or default\r\n        ...docSnap.data(),\r\n      }));\r\n      setQueries(results);\r\n    } catch (error) {\r\n      console.error(\"Error fetching user queries:\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const markAsSolved = async (id) => {\r\n    try {\r\n      const queryRef = doc(db, \"concerns\", id);\r\n      await updateDoc(queryRef, { solved: true });\r\n      setQueries((prev) =>\r\n        prev.map((q) => (q.id === id ? { ...q, solved: true } : q))\r\n      );\r\n      toast.success(\"Marked as solved!\");\r\n    } catch (error) {\r\n      console.error(\"Error marking query as solved:\", error);\r\n      toast.error(\"Failed to mark as solved.\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchQueries();\r\n  }, []);\r\n\r\n  const filteredQueries = queries.filter((q) => {\r\n    if (filter === \"solved\") return q.solved === true;\r\n    if (filter === \"unsolved\") return !q.solved;\r\n    return true;\r\n  });\r\n\r\n  if (loading) {\r\n    return <div className=\"text-center mt-5\">Loading queries...</div>;\r\n  }\r\n\r\n  if (filteredQueries.length === 0) {\r\n    return <div className=\"text-center mt-5\">No user queries found.</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mt-4\">\r\n      <h2 className=\"mb-4 text-center\">User Queries</h2>\r\n\r\n      {/* Filter dropdown */}\r\n      <div className=\"mb-3 text-start\">\r\n        <select\r\n          className=\"form-select w-auto d-inline-block\"\r\n          value={filter}\r\n          onChange={(e) => setFilter(e.target.value)}\r\n        >\r\n          <option value=\"all\">All</option>\r\n          <option value=\"unsolved\">Unsolved</option>\r\n          <option value=\"solved\">Solved</option>\r\n        </select>\r\n      </div>\r\n\r\n      {/* Query list */}\r\n      <ul className=\"list-group\">\r\n        {filteredQueries.map((query) => (\r\n          <li\r\n            key={query.id}\r\n            className=\"list-group-item d-flex justify-content-between align-items-start\"\r\n          >\r\n            <div>\r\n              <h5>\r\n                {query.name}{\" \"}\r\n                {query.solved && <span className=\"badge bg-success\">Solved</span>}\r\n              </h5>\r\n              <p className=\"m-0\">{query.phone}</p>\r\n              <p className=\"mb-1\">{query.query}</p>\r\n              <small className=\"text-muted\">\r\n                {query.timestamp?.toDate().toLocaleString() || \"No timestamp\"}\r\n              </small>\r\n            </div>\r\n            {!query.solved && (\r\n              <button\r\n                className=\"btn btn-sm btn-success\"\r\n                onClick={() => markAsSolved(query.id)}\r\n              >\r\n                Mark Solved\r\n              </button>\r\n            )}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserQueries;\r\n"],"names":[],"mappings":"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"}