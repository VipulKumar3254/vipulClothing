{"version":3,"sources":["../../../../src/app/adminPanel/productsWeOffer/page.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { db, storage } from \"@/firebaseConfig\"; // adjust import path\r\nimport { collection, getDocs, doc, deleteDoc } from \"firebase/firestore\";\r\nimport { ref, deleteObject } from \"firebase/storage\";\r\nimport Link from \"next/link\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nexport default function ProductsWeOffer() {\r\n  const [products, setProducts] = useState([]);\r\n\r\n  useEffect(() => {\r\n    fetchProducts();\r\n  }, []);\r\n\r\n  const fetchProducts = async () => {\r\n    try {\r\n      const querySnapshot = await getDocs(\r\n        collection(db, \"admin\", \"productsWeOffer\", \"products\")\r\n      );\r\n      const productsArray = querySnapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n      setProducts(productsArray);\r\n    } catch (error) {\r\n      console.error(\"Error fetching products: \", error);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (productId, imgSrc) => {\r\n    const confirmDelete = window.confirm(\r\n      \"Are you sure you want to delete this product?\"\r\n    );\r\n    if (!confirmDelete) return;\r\n\r\n    try {\r\n      // Extract file path from image URL\r\n      const fileName = imgSrc.split(\"/o/\")[1].split(\"?\")[0];\r\n      const storageRef = ref(storage, decodeURIComponent(fileName));\r\n\r\n      // Delete image from storage\r\n      await deleteObject(storageRef);\r\n\r\n      // Delete Firestore doc\r\n      await deleteDoc(\r\n        doc(db, \"admin\", \"productsWeOffer\", \"products\", productId)\r\n      );\r\n\r\n      // Update UI\r\n      setProducts((prev) => prev.filter((p) => p.id !== productId));\r\n\r\n      alert(\"Product and image deleted successfully!\");\r\n    } catch (error) {\r\n      console.error(\"Error deleting product:\", error);\r\n      alert(\"Failed to delete product.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"container mt-3\">\r\n        <Link className=\"btn btn-primary\" href=\"/adminPanel/productsWeOffer/add\">\r\n          Add Products\r\n        </Link>\r\n      </div>\r\n\r\n      <div className=\"container mt-4\">\r\n        <h2 className=\"text-center mb-4\">All Products</h2>\r\n        <div className=\"row\">\r\n          {products.length > 0 ? (\r\n            products.map((product) => (\r\n              <div\r\n                key={product.id}\r\n                className=\"col-lg-3 col-md-6 col-sm-12 mb-4\"\r\n              >\r\n                <div className=\"card shadow-sm text-center\">\r\n                  <img\r\n                    src={product.imgSrc}\r\n                    className=\"card-img-top\"\r\n                    alt={product.name}\r\n                    style={{\r\n                      height: \"200px\",\r\n                      width: \"300px\",\r\n                      objectFit: \"contain\",\r\n                    }}\r\n                  />\r\n                  <div className=\"card-body\">\r\n                    <h5 className=\"card-title\">{product.path}</h5>\r\n                    <div className=\"d-flex justify-content-center align-items-center\">\r\n                      <a\r\n                        href={product.path}\r\n                        className=\"btn btn-primary\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                      >\r\n                        View Product\r\n                      </a>\r\n                      <button\r\n                        className=\"m-0 ms-2 btn btn-danger\"\r\n                        onClick={() =>\r\n                          handleDelete(product.id, product.imgSrc)\r\n                        }\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))\r\n          ) : (\r\n            <div className=\"col-12 text-center\">\r\n              <p>Loading products...</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}